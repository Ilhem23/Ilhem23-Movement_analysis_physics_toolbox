"0","extract_feature_long = function(data,threeshold_mean,threeshold_sd,threeshold_t){"
"0","  if(""...11"" %in% colnames(data))"
"0","  {"
"0","    data = data %>% select(-c(...11))"
"0","  }"
"0","  "
"0","  data= data %>% mutate(gN= abs((gFx * gFx) + (gFy * gFy) + (gFz * gFz) - 0.8 ))"
"0","  data= data %>% mutate(gNm = roll_meanl(gN, 10))"
"0","  data= data %>% mutate(gNsd = roll_sdl(gN, 10))"
"0","  dataCopy= data %>% filter(gNm <= threeshold_mean | gNsd <= threeshold_sd)"
"0","  data= data %>% filter(gNm > threeshold_mean & gNsd > threeshold_sd)"
"0","  data= data %>% mutate(tm= lag(time)) %>% mutate(dt = time - tm) %>% select(-c(tm))"
"0","  data = data %>% mutate(switch= if_else(dt > threeshold_t, 1, 0))"
"0","  data= data %>% mutate(switch= if_else(is.na(dt),1,switch))"
"0","  vector= rep(1, sum(data$switch))"
"0","  data= group(data, n=vector, method='l_starts',col_name = 'pid', starts_col = 'switch')"
"0","  data = data %>% mutate(pid= as.numeric(pid), pid= if_else(switch== 1, 0, pid))"
"0","  dataCopy= dataCopy %>% mutate(dt= 0)"
"0","  dataCopy= dataCopy %>% mutate(pid= 0)"
"0","  dataCopy= dataCopy %>% mutate(switch= 0)"
"0","  data_res= bind_rows(data, dataCopy)"
"0","  return(data_res)"
"0","}"
